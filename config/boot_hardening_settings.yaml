# Boot Hardening Agent Configuration

version: "1.0"

# Agent Settings
agent:
  name: "OS Sentry"
  confidence_threshold: 0.8  # Require 80% confidence for auto-approval
  max_execution_time: 30     # seconds
  fail_safe: true            # Do nothing on error

# Analysis Settings
analysis:
  # Process Analysis
  process_monitoring:
    enabled: true
    suspicious_patterns:
      - "*miner*.exe"
      - "*crypto*.exe"
      - "*.tmp.exe"
    whitelist:
      - "system32"
      - "Program Files"
      
  # Startup Analysis
  startup_monitoring:
    enabled: true
    check_autoruns: true
    check_scheduled_tasks: true
    check_services: true
    
  # Network Analysis
  network_monitoring:
    enabled: true
    check_listening_ports: true
    check_established_connections: true
    alert_on_suspicious_ports: [4444, 5555, 6666, 31337]

# Actions
actions:
  # Automatic Actions (high confidence)
  auto_approve:
    - type: "firewall_rule_add"
      conditions:
        - confidence: ">= 0.9"
        - change_type: "block_suspicious"
        
  # Require Human Approval
  require_approval:
    - type: "firewall_rule_modify"
      reason: "Modifying existing rules is risky"
      
    - type: "process_terminate"
      reason: "Killing processes requires approval"
      
  # Never Allow
  forbidden:
    - type: "system_reboot"
    - type: "delete_files"

# Reporting
reporting:
  generate_report: true
  report_format: "markdown"
  report_location: "logs/boot_hardening_reports"
  include:
    - "summary"
    - "changes_applied"
    - "suspicious_items"
    - "recommendations"
    
# Integration
integration:
  simplewall:
    enabled: true
    cli_path: "${SIMPLEWALL_PATH}\\simplewall.exe"
    profile: "strict"
    
  sysinternals:
    enabled: true
    tools_path: "${SYSINTERNALS_PATH}"
    autoruns_path: "${SYSINTERNALS_PATH}\\autoruns.exe"
    
# Notifications
notifications:
  enabled: true
  channels:
    - type: "log"
      level: "info"
    - type: "email"
      enabled: false
      recipients: []
      
# Schedule
schedule:
  on_boot: true
  daily_scan: "00:00"  # Midnight
  weekly_deep_scan: "Sunday 02:00"
