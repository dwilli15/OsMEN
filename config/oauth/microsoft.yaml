# Microsoft OAuth 2.0 Configuration
# Azure AD integration for Microsoft Graph API access

provider: microsoft
type: oauth2

# Azure AD OAuth endpoints (v2.0)
# Tenant can be: 'common', 'organizations', 'consumers', or specific tenant ID
tenant: common

auth_endpoint: https://login.microsoftonline.com/{tenant}/oauth2/v2.0/authorize
token_endpoint: https://login.microsoftonline.com/{tenant}/oauth2/v2.0/token
logout_endpoint: https://login.microsoftonline.com/{tenant}/oauth2/v2.0/logout

# OAuth Application Credentials
# Set these in environment variables for security
client_id: ${MICROSOFT_CLIENT_ID}
client_secret: ${MICROSOFT_CLIENT_SECRET}

# Redirect URI for OAuth callback
redirect_uri: http://localhost:8080/oauth/callback/microsoft

# Microsoft Graph API Scopes
# Always include 'offline_access' for refresh tokens
scopes:
  # Calendar access
  - https://graph.microsoft.com/Calendars.Read
  - https://graph.microsoft.com/Calendars.ReadWrite
  
  # Mail access
  - https://graph.microsoft.com/Mail.Read
  - https://graph.microsoft.com/Mail.ReadWrite
  - https://graph.microsoft.com/Mail.Send
  
  # Contacts access
  - https://graph.microsoft.com/Contacts.Read
  - https://graph.microsoft.com/Contacts.ReadWrite
  
  # User profile
  - https://graph.microsoft.com/User.Read
  
  # Refresh token support (REQUIRED)
  - offline_access

# Tenant Options:
# - 'common': Any Microsoft account or work/school account
# - 'organizations': Work or school accounts only
# - 'consumers': Personal Microsoft accounts only
# - '<tenant-id>': Specific organization only

# Admin Consent:
# Some scopes may require admin consent for organization-wide access
# Use the admin consent flow if needed

# Token Characteristics:
# - Access tokens typically expire in 1 hour
# - Refresh tokens do not expire but can be revoked
# - Microsoft returns NEW refresh token on each refresh (rotate)
# - id_token contains user information (JWT format)
