<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - OsMEN</title>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --border: #475569;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 24px;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            padding-bottom: 24px;
            border-bottom: 1px solid var(--border);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo h1 {
            font-size: 24px;
            font-weight: 700;
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--info));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .nav-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 8px;
        }
        
        .nav-tab {
            padding: 10px 20px;
            border-radius: 8px 8px 0 0;
            background: transparent;
            color: var(--text-secondary);
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .nav-tab:hover {
            color: var(--text-primary);
            background: var(--bg-tertiary);
        }
        
        .nav-tab.active {
            color: var(--primary);
            background: var(--bg-secondary);
            border-bottom: 2px solid var(--primary);
        }
        
        .settings-panel {
            background: var(--bg-secondary);
            border-radius: 16px;
            border: 1px solid var(--border);
            padding: 24px;
            display: none;
        }
        
        .settings-panel.active {
            display: block;
        }
        
        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }
        
        .setting-group {
            margin-bottom: 24px;
        }
        
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            margin-bottom: 12px;
        }
        
        .setting-info {
            flex: 1;
        }
        
        .setting-label {
            font-weight: 500;
            margin-bottom: 4px;
        }
        
        .setting-description {
            font-size: 13px;
            color: var(--text-secondary);
        }
        
        .setting-control {
            margin-left: 24px;
        }
        
        input[type="text"],
        input[type="password"],
        input[type="number"],
        select,
        textarea {
            padding: 10px 14px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 14px;
            width: 250px;
        }
        
        input[type="text"]:focus,
        input[type="password"]:focus,
        input[type="number"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        textarea {
            width: 100%;
            min-height: 100px;
            resize: vertical;
        }
        
        .toggle {
            position: relative;
            width: 48px;
            height: 26px;
            background: var(--bg-primary);
            border-radius: 13px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .toggle.active {
            background: var(--primary);
        }
        
        .toggle-knob {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.2s;
        }
        
        .toggle.active .toggle-knob {
            transform: translateX(22px);
        }
        
        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
        }
        
        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }
        
        .btn-secondary:hover {
            background: var(--border);
        }
        
        .btn-danger {
            background: var(--error);
            color: white;
        }
        
        .btn-danger:hover {
            opacity: 0.9;
        }
        
        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }
        
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-badge.connected {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }
        
        .status-badge.disconnected {
            background: rgba(239, 68, 68, 0.2);
            color: var(--error);
        }
        
        .status-badge.pending {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: currentColor;
        }
        
        .oauth-card {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            margin-bottom: 12px;
        }
        
        .oauth-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            background: var(--bg-primary);
        }
        
        .oauth-info {
            flex: 1;
        }
        
        .oauth-name {
            font-weight: 500;
            margin-bottom: 4px;
        }
        
        .oauth-status {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .notification-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            margin-bottom: 8px;
        }
        
        .notification-icon {
            font-size: 20px;
        }
        
        .notification-text {
            flex: 1;
        }
        
        .notification-name {
            font-weight: 500;
            font-size: 14px;
        }
        
        .notification-desc {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .danger-zone {
            border: 1px solid var(--error);
            border-radius: 8px;
            padding: 16px;
            margin-top: 32px;
        }
        
        .danger-zone h3 {
            color: var(--error);
            margin-bottom: 12px;
        }
        
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            padding: 16px 24px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            gap: 12px;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s;
        }
        
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .toast.success {
            border-left: 3px solid var(--success);
        }
        
        .toast.error {
            border-left: 3px solid var(--error);
        }
        
        @media (max-width: 768px) {
            .setting-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .setting-control {
                margin-left: 0;
                margin-top: 12px;
                width: 100%;
            }
            
            input[type="text"],
            input[type="password"],
            select {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">‚öôÔ∏è</div>
                <h1>Settings</h1>
            </div>
            <button class="btn btn-primary" onclick="saveAllSettings()">Save Changes</button>
        </header>
        
        <nav class="nav-tabs">
            <button class="nav-tab active" onclick="showPanel('llm')">LLM Providers</button>
            <button class="nav-tab" onclick="showPanel('oauth')">OAuth</button>
            <button class="nav-tab" onclick="showPanel('workflows')">Workflows</button>
            <button class="nav-tab" onclick="showPanel('notifications')">Notifications</button>
            <button class="nav-tab" onclick="showPanel('advanced')">Advanced</button>
        </nav>
        
        <!-- LLM Provider Settings -->
        <div id="panel-llm" class="settings-panel active">
            <h2 class="section-title">LLM Provider Configuration</h2>
            
            <div class="setting-group">
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Default Provider</div>
                        <div class="setting-description">Select the default LLM provider for workflows</div>
                    </div>
                    <div class="setting-control">
                        <select id="default-provider">
                            <option value="local">Local (Ollama)</option>
                            <option value="openai">OpenAI</option>
                            <option value="anthropic">Anthropic</option>
                        </select>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Local Fallback</div>
                        <div class="setting-description">Fall back to local LLM if cloud provider fails</div>
                    </div>
                    <div class="setting-control">
                        <div class="toggle active" onclick="toggleSwitch(this)" data-setting="local-fallback">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <h3 style="margin: 24px 0 16px; font-size: 16px;">OpenAI</h3>
            <div class="setting-group">
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">API Key</div>
                        <div class="setting-description">Your OpenAI API key (sk-...)</div>
                    </div>
                    <div class="setting-control">
                        <input type="password" id="openai-api-key" placeholder="sk-...">
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Default Model</div>
                        <div class="setting-description">Model to use for OpenAI requests</div>
                    </div>
                    <div class="setting-control">
                        <select id="openai-model">
                            <option value="gpt-4o">GPT-4o</option>
                            <option value="gpt-4-turbo">GPT-4 Turbo</option>
                            <option value="gpt-4">GPT-4</option>
                            <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <h3 style="margin: 24px 0 16px; font-size: 16px;">Anthropic</h3>
            <div class="setting-group">
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">API Key</div>
                        <div class="setting-description">Your Anthropic API key</div>
                    </div>
                    <div class="setting-control">
                        <input type="password" id="anthropic-api-key" placeholder="sk-ant-...">
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Default Model</div>
                        <div class="setting-description">Model to use for Anthropic requests</div>
                    </div>
                    <div class="setting-control">
                        <select id="anthropic-model">
                            <option value="claude-3-5-sonnet-20241022">Claude 3.5 Sonnet</option>
                            <option value="claude-3-opus-20240229">Claude 3 Opus</option>
                            <option value="claude-3-sonnet-20240229">Claude 3 Sonnet</option>
                            <option value="claude-3-haiku-20240307">Claude 3 Haiku</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <h3 style="margin: 24px 0 16px; font-size: 16px;">Ollama (Local)</h3>
            <div class="setting-group">
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Ollama URL</div>
                        <div class="setting-description">URL of your Ollama instance</div>
                    </div>
                    <div class="setting-control">
                        <input type="text" id="ollama-url" value="http://localhost:11434">
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Default Model</div>
                        <div class="setting-description">Model to use for local inference</div>
                    </div>
                    <div class="setting-control">
                        <select id="ollama-model">
                            <option value="llama3.2">Llama 3.2</option>
                            <option value="llama3.1">Llama 3.1</option>
                            <option value="mistral">Mistral</option>
                            <option value="codellama">CodeLlama</option>
                            <option value="phi">Phi</option>
                        </select>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Auto-pull Models</div>
                        <div class="setting-description">Automatically download models if not present</div>
                    </div>
                    <div class="setting-control">
                        <div class="toggle active" onclick="toggleSwitch(this)" data-setting="auto-pull">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- OAuth Settings -->
        <div id="panel-oauth" class="settings-panel">
            <h2 class="section-title">OAuth Integrations</h2>
            
            <div class="oauth-card">
                <div class="oauth-icon">üìÖ</div>
                <div class="oauth-info">
                    <div class="oauth-name">Google Calendar</div>
                    <div class="oauth-status">Access your Google Calendar events</div>
                </div>
                <span class="status-badge disconnected">
                    <span class="status-dot"></span>
                    Not Connected
                </span>
                <button class="btn btn-primary" onclick="connectOAuth('google')">Connect</button>
            </div>
            
            <div class="oauth-card">
                <div class="oauth-icon">üìß</div>
                <div class="oauth-info">
                    <div class="oauth-name">Gmail</div>
                    <div class="oauth-status">Read and organize your emails</div>
                </div>
                <span class="status-badge disconnected">
                    <span class="status-dot"></span>
                    Not Connected
                </span>
                <button class="btn btn-primary" onclick="connectOAuth('gmail')">Connect</button>
            </div>
            
            <div class="oauth-card">
                <div class="oauth-icon">üìÜ</div>
                <div class="oauth-info">
                    <div class="oauth-name">Microsoft Calendar</div>
                    <div class="oauth-status">Access your Outlook calendar</div>
                </div>
                <span class="status-badge disconnected">
                    <span class="status-dot"></span>
                    Not Connected
                </span>
                <button class="btn btn-primary" onclick="connectOAuth('microsoft')">Connect</button>
            </div>
            
            <div class="oauth-card">
                <div class="oauth-icon">‚úâÔ∏è</div>
                <div class="oauth-info">
                    <div class="oauth-name">Outlook Mail</div>
                    <div class="oauth-status">Read and organize your Outlook emails</div>
                </div>
                <span class="status-badge disconnected">
                    <span class="status-dot"></span>
                    Not Connected
                </span>
                <button class="btn btn-primary" onclick="connectOAuth('outlook')">Connect</button>
            </div>
            
            <h3 style="margin: 32px 0 16px; font-size: 16px;">OAuth Credentials</h3>
            <div class="setting-group">
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Google Client ID</div>
                        <div class="setting-description">From Google Cloud Console</div>
                    </div>
                    <div class="setting-control">
                        <input type="text" id="google-client-id" placeholder="xxxxx.apps.googleusercontent.com">
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Google Client Secret</div>
                        <div class="setting-description">OAuth client secret</div>
                    </div>
                    <div class="setting-control">
                        <input type="password" id="google-client-secret" placeholder="GOCSPX-...">
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Microsoft Client ID</div>
                        <div class="setting-description">From Azure AD App Registration</div>
                    </div>
                    <div class="setting-control">
                        <input type="text" id="microsoft-client-id" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Microsoft Client Secret</div>
                        <div class="setting-description">OAuth client secret</div>
                    </div>
                    <div class="setting-control">
                        <input type="password" id="microsoft-client-secret" placeholder="...">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Workflow Settings -->
        <div id="panel-workflows" class="settings-panel">
            <h2 class="section-title">Workflow Configuration</h2>
            
            <h3 style="margin: 16px 0; font-size: 16px;">Daily Brief</h3>
            <div class="setting-group">
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Schedule Time</div>
                        <div class="setting-description">When to generate your daily brief</div>
                    </div>
                    <div class="setting-control">
                        <input type="text" id="daily-brief-time" value="07:00" placeholder="HH:MM">
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Include Calendar</div>
                        <div class="setting-description">Include today's calendar events</div>
                    </div>
                    <div class="setting-control">
                        <div class="toggle active" onclick="toggleSwitch(this)" data-setting="brief-calendar">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Include Email Summary</div>
                        <div class="setting-description">Summarize unread emails</div>
                    </div>
                    <div class="setting-control">
                        <div class="toggle active" onclick="toggleSwitch(this)" data-setting="brief-email">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Include Tasks</div>
                        <div class="setting-description">Include due and priority tasks</div>
                    </div>
                    <div class="setting-control">
                        <div class="toggle active" onclick="toggleSwitch(this)" data-setting="brief-tasks">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <h3 style="margin: 24px 0 16px; font-size: 16px;">Approval Settings</h3>
            <div class="setting-group">
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Require Approval for External Emails</div>
                        <div class="setting-description">Get approval before sending to external domains</div>
                    </div>
                    <div class="setting-control">
                        <div class="toggle active" onclick="toggleSwitch(this)" data-setting="approve-email">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Require Approval for Shell Commands</div>
                        <div class="setting-description">Always require approval for command execution</div>
                    </div>
                    <div class="setting-control">
                        <div class="toggle active" onclick="toggleSwitch(this)" data-setting="approve-shell">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Approval Timeout (seconds)</div>
                        <div class="setting-description">Time to wait for approval before timeout</div>
                    </div>
                    <div class="setting-control">
                        <input type="number" id="approval-timeout" value="300" min="30" max="3600">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Notification Settings -->
        <div id="panel-notifications" class="settings-panel">
            <h2 class="section-title">Notification Preferences</h2>
            
            <div class="notification-item">
                <span class="notification-icon">üîî</span>
                <div class="notification-text">
                    <div class="notification-name">Workflow Completed</div>
                    <div class="notification-desc">Notify when a workflow finishes</div>
                </div>
                <div class="toggle active" onclick="toggleSwitch(this)" data-setting="notify-complete">
                    <div class="toggle-knob"></div>
                </div>
            </div>
            
            <div class="notification-item">
                <span class="notification-icon">‚ùå</span>
                <div class="notification-text">
                    <div class="notification-name">Workflow Failed</div>
                    <div class="notification-desc">Notify when a workflow encounters an error</div>
                </div>
                <div class="toggle active" onclick="toggleSwitch(this)" data-setting="notify-error">
                    <div class="toggle-knob"></div>
                </div>
            </div>
            
            <div class="notification-item">
                <span class="notification-icon">‚úã</span>
                <div class="notification-text">
                    <div class="notification-name">Approval Required</div>
                    <div class="notification-desc">Notify when an action needs approval</div>
                </div>
                <div class="toggle active" onclick="toggleSwitch(this)" data-setting="notify-approval">
                    <div class="toggle-knob"></div>
                </div>
            </div>
            
            <div class="notification-item">
                <span class="notification-icon">üìä</span>
                <div class="notification-text">
                    <div class="notification-name">Daily Summary</div>
                    <div class="notification-desc">Daily summary of all workflow activity</div>
                </div>
                <div class="toggle" onclick="toggleSwitch(this)" data-setting="notify-summary">
                    <div class="toggle-knob"></div>
                </div>
            </div>
            
            <h3 style="margin: 32px 0 16px; font-size: 16px;">Notification Channels</h3>
            <div class="setting-group">
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Browser Notifications</div>
                        <div class="setting-description">Show desktop notifications</div>
                    </div>
                    <div class="setting-control">
                        <div class="toggle active" onclick="toggleSwitch(this); requestNotificationPermission()" data-setting="browser-notify">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Email Notifications</div>
                        <div class="setting-description">Send notifications to email</div>
                    </div>
                    <div class="setting-control">
                        <div class="toggle" onclick="toggleSwitch(this)" data-setting="email-notify">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Notification Email</div>
                        <div class="setting-description">Email address for notifications</div>
                    </div>
                    <div class="setting-control">
                        <input type="text" id="notification-email" placeholder="you@example.com">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Advanced Settings -->
        <div id="panel-advanced" class="settings-panel">
            <h2 class="section-title">Advanced Settings</h2>
            
            <div class="setting-group">
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">API Rate Limit (requests/min)</div>
                        <div class="setting-description">Maximum API requests per minute</div>
                    </div>
                    <div class="setting-control">
                        <input type="number" id="rate-limit" value="60" min="10" max="1000">
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Max Retries</div>
                        <div class="setting-description">Number of retry attempts on failure</div>
                    </div>
                    <div class="setting-control">
                        <input type="number" id="max-retries" value="3" min="0" max="10">
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Temperature</div>
                        <div class="setting-description">LLM temperature (0.0-2.0)</div>
                    </div>
                    <div class="setting-control">
                        <input type="number" id="temperature" value="0.7" min="0" max="2" step="0.1">
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Max Tokens</div>
                        <div class="setting-description">Maximum tokens per response</div>
                    </div>
                    <div class="setting-control">
                        <input type="number" id="max-tokens" value="4096" min="256" max="128000">
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Debug Mode</div>
                        <div class="setting-description">Enable verbose logging for troubleshooting</div>
                    </div>
                    <div class="setting-control">
                        <div class="toggle" onclick="toggleSwitch(this)" data-setting="debug-mode">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="danger-zone">
                <h3>Danger Zone</h3>
                <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 16px;">
                    These actions are irreversible. Please proceed with caution.
                </p>
                <div class="btn-group">
                    <button class="btn btn-danger" onclick="clearAllData()">Clear All Run History</button>
                    <button class="btn btn-danger" onclick="resetToDefaults()">Reset to Defaults</button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="toast" class="toast">
        <span id="toast-message">Settings saved successfully!</span>
    </div>
    
    <script>
        // Settings state
        let settings = {
            toggles: {},
            inputs: {}
        };
        
        // Load settings from localStorage
        function loadSettings() {
            const saved = localStorage.getItem('osmen_settings');
            if (saved) {
                settings = JSON.parse(saved);
                applySettings();
            }
        }
        
        // Apply settings to UI
        function applySettings() {
            // Apply toggles
            document.querySelectorAll('.toggle').forEach(toggle => {
                const key = toggle.dataset.setting;
                if (settings.toggles[key] !== undefined) {
                    if (settings.toggles[key]) {
                        toggle.classList.add('active');
                    } else {
                        toggle.classList.remove('active');
                    }
                }
            });
            
            // Apply inputs
            Object.keys(settings.inputs).forEach(key => {
                const input = document.getElementById(key);
                if (input) {
                    input.value = settings.inputs[key];
                }
            });
        }
        
        // Show panel
        function showPanel(panelId) {
            document.querySelectorAll('.settings-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(`panel-${panelId}`).classList.add('active');
            event.target.classList.add('active');
        }
        
        // Toggle switch
        function toggleSwitch(element) {
            element.classList.toggle('active');
            const key = element.dataset.setting;
            settings.toggles[key] = element.classList.contains('active');
        }
        
        // Save all settings
        function saveAllSettings() {
            // Collect all input values
            document.querySelectorAll('input, select').forEach(input => {
                if (input.id) {
                    settings.inputs[input.id] = input.value;
                }
            });
            
            // Collect all toggle states
            document.querySelectorAll('.toggle').forEach(toggle => {
                const key = toggle.dataset.setting;
                if (key) {
                    settings.toggles[key] = toggle.classList.contains('active');
                }
            });
            
            // Save to localStorage
            localStorage.setItem('osmen_settings', JSON.stringify(settings));
            
            // Show toast
            showToast('Settings saved successfully!', 'success');
            
            // Send to backend
            saveToBackend();
        }
        
        // Save settings to backend
        async function saveToBackend() {
            try {
                const response = await fetch('/api/settings', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(settings)
                });
                
                if (!response.ok) {
                    console.warn('Failed to save to backend');
                }
            } catch (error) {
                console.warn('Backend save error:', error);
            }
        }
        
        // Show toast notification
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            
            toastMessage.textContent = message;
            toast.className = `toast ${type} show`;
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Connect OAuth
        function connectOAuth(provider) {
            const redirectUri = encodeURIComponent(window.location.origin + '/oauth/callback');
            let authUrl;
            
            switch (provider) {
                case 'google':
                case 'gmail':
                    const googleClientId = document.getElementById('google-client-id').value;
                    if (!googleClientId) {
                        showToast('Please enter Google Client ID first', 'error');
                        return;
                    }
                    const googleScope = provider === 'gmail' 
                        ? 'https://www.googleapis.com/auth/gmail.readonly'
                        : 'https://www.googleapis.com/auth/calendar.readonly';
                    authUrl = `https://accounts.google.com/o/oauth2/v2/auth?client_id=${googleClientId}&redirect_uri=${redirectUri}&response_type=code&scope=${encodeURIComponent(googleScope)}&access_type=offline`;
                    break;
                    
                case 'microsoft':
                case 'outlook':
                    const msClientId = document.getElementById('microsoft-client-id').value;
                    if (!msClientId) {
                        showToast('Please enter Microsoft Client ID first', 'error');
                        return;
                    }
                    const msScope = provider === 'outlook'
                        ? 'Mail.Read'
                        : 'Calendars.Read';
                    authUrl = `https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=${msClientId}&redirect_uri=${redirectUri}&response_type=code&scope=${encodeURIComponent(msScope)}`;
                    break;
            }
            
            if (authUrl) {
                window.open(authUrl, 'oauth', 'width=600,height=700');
            }
        }
        
        // Request notification permission
        function requestNotificationPermission() {
            if ('Notification' in window && Notification.permission !== 'granted') {
                Notification.requestPermission();
            }
        }
        
        // Clear all data
        function clearAllData() {
            if (confirm('Are you sure you want to clear all run history? This cannot be undone.')) {
                localStorage.removeItem('osmen_runs');
                showToast('Run history cleared', 'success');
            }
        }
        
        // Reset to defaults
        function resetToDefaults() {
            if (confirm('Are you sure you want to reset all settings to defaults?')) {
                localStorage.removeItem('osmen_settings');
                settings = { toggles: {}, inputs: {} };
                location.reload();
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadSettings();
        });
    </script>
</body>
</html>
